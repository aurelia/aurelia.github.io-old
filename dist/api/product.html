<template>
  <require from="resources/function-heading"></require>
  <require from="./product.css"></require>

  <au-view class="content product">

    <au-card title-card>
      <header>
        <h1>${product.productName}</h1>
        <span class="card-control">
          <!-- <au-tag class="card-control">${selectedProductVersion.version}</au-tag> -->
          <select class="au-tag" value.bind="selectedVersion">
            <option repeat.for="version of product.availableVersions" model.bind="version.version">${version.display}</option>
          </select>
        </span>
      </header>

      <article>
        <blockquote border-bottom>
          <h3 description if.bind="selectedProductVersion.description">${selectedProductVersion.description}</h3>
        </blockquote>
        <ul class="inline-list" if.bind="selectedProductVersion.keywords">
          <li list-heading>Keywords</li>
          <template repeat.for="keyword of selectedProductVersion.keywords">
            <li list-item>${keyword}</li>
          </template>
        </ul>

        <div class="spaced">
          <a class="au-button" href.bind="selectedProductVersion.changeLogUrl" target="_blank">Changes</a>
          <a class="au-button" href.bind="selectedProductVersion.bugsUrl" target="_blank">Issues</a>
          <a class="au-button" href.bind="selectedProductVersion.licenseUrl" target="_blank">License</a>
          <a class="au-button" href.bind="selectedProductVersion.repositoryUrl" target="_blank">Repository</a>
          <a class="au-button" href.bind="product.npmUrl" target="_blank">NPM</a>
        </div>
      </article>
    </au-card>

    <au-card>

      <template if.bind="isDeps">
        <blockquote border-bottom>
          <h2>Dependencies</h2>
        </blockquote>
        <article>
          <ul class="stack-list" no-bullet gutter underline source-code>
            <li repeat.for="dependency of selectedProductVersion.dependencies">
              <a color="accent" href="#/${dependency.userName}/${dependency.productName}/${dependency.preferredVersion}/doc/api/overview">aurelia-${dependency.productName}</a>
            </li>
          </ul>
        </article>
      </template>

      <article>
        <template if.bind="api.classes.length">
          <h3 color="primary-dark">Classes</h3>
          <ul list-style class="grid-list" gutter="2x">
            <li class-aucon repeat.for="child of api.classes" color="primary-dark">
              <a trans="6" href="#/${$parent.product.userName}/${$parent.product.productName}/${$parent.product.preferredVersion}/doc/api/class/${child.name}">
                ${child.name}
              </a>
            </li>
            <li></li>
          </ul>
        </template>

        <template if.bind="api.interfaces.length">
          <h3 color="primary-dark">Interfaces</h3>
          <ul list-style class="grid-list" gutter="2x">
            <li interface-aucon repeat.for="child of api.interfaces" color="primary-dark">
              <a trans="6" href="#/${$parent.product.userName}/${$parent.product.productName}/${$parent.product.preferredVersion}/doc/api/interface/${child.name}">
                ${child.name}
              </a>
            </li>
            <li></li>
          </ul>
        </template>

        <template if.bind="api.variables.length">
          <h3 color="primary-dark">Constants</h3>
          <ul list-style class="grid-list" gutter="2x">
            <li constant-aucon repeat.for="child of api.variables" color="primary-dark">
              <a trans="6" click.trigger="scrollTo('variable', child.name)">
                ${child.name}
              </a>
            </li>
            <li></li>
          </ul>
        </template>

        <template if.bind="api.functions.length">
          <h3 color="primary-dark">Functions</h3>
          <ul list-style class="grid-list" gutter="2x">
            <li function-aucon repeat.for="child of api.functions" color="primary-dark">
              <a trans="6" click.trigger="scrollTo('function', child.name)">
                ${child.name}
              </a>
            </li>
            <li></li>
          </ul>
        </template>
      </article>
    </au-card>

    <template if.bind="api.variables.length">
      <h1 gutter>Constants</h1>
      <template repeat.for="variable of api.variables">
        <au-card variable-card>
          <blockquote id="variable-${variable.name}">
            <h2 constant-heading border-bottom>${variable.name}: <span value-type>${variable.type.name}</span></h2>
            <div description>${variable.comment.shortText || 'no description available'}</div>
          </blockquote>
        </au-card>
      </template>
    </template>

    <template if.bind="api.functions.length">
      <h1 gutter>Functions</h1>
      <template repeat.for="function of api.functions">
        <au-card function-card>
          <blockquote id="function-${function.signature.name}">
            <function-heading border-bottom function.bind="function"></function-heading>
            <div description>${function.signature.comment.shortText || 'no description available'}</div>
          </blockquote>

          <article if.bind="function.signature.parameters.length > 0">
            <br>
            <h3 bold>Parameters: </h3>
            <ul class="stack-list" gutter>
              <li repeat.for="param of function.signature.parameters">
                <strong>${param.name}: ${param.type.name || 'any'}</strong>
                <p>${param.comment.text || 'no description available'}</p>
              </li>
            </ul>
          </article>
        </au-card>
      </template>
    </template>

  </au-view>
</template>
