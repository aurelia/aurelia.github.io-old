{"name":"Webpack (default)","description":"Webpack and the Aurelia CLI.","author":{"name":"Jeroen Vinke","url":"https://jeroenvinke.nl"},"links":{"static":"docs/cli/webpack","html":"docs/cli/webpack/index.html","fragment":"docs/cli/webpack/index-fragment.html","self":"docs/cli/webpack/index.json"},"content":"\n\n## Introduction\nThe Aurelia CLI fully supports Webpack. When you create a new project with `au new`, the default choice is Webpack for both esnext and TypeScript application. This page is specifically for people using the Webpack bundler.\n\nThe Aurelia CLI will generate a `webpack.config.js` based on the technology that you select during `au new`. Like SASS more than LESS? Jest more than Karma? The Aurelia CLI can configure `webpack.config.js` just how you like it.\n\nThe generated project makes use of the aurelia-webpack-plugin. As opposed to the Aurelia CLI Bundler, the bundle configuration is in the `webpack.config.js`, and not in `aurelia.json`.\n\nIf you would like to learn more about Webpack, take a look at the following resources:\n- https://www.pluralsight.com/courses/webpack-fundamentals\n- https://blog.madewithenvy.com/getting-started-with-webpack-2-ed2b86c68783\n- https://webpack.js.org/configuration/\n\n> Info\n> Webpack projects that are generated using the Aurelia-CLI require a relatively high version of Node.js (atleast v8.9.0). Some Webpack 4 plugins (such as `mini-css-extract-plugin`) need this in order to work correctly.\n\n## PLATFORM.moduleName\n\nThis is the first thing you need to know about Aurelia app in Webpack. Whenever you reference a module by string, you need to use `PLATFORM.moduleName(\"moduleName\")` to wrap the bare string. `PLATFORM.moduleName` is designed to teach Webpack about Aurelia's dynamic loading behavior.\n\n```\n// src/resources/index.js\nconfig.globalResources([\n  PLATFORM.moduleName('./elements/my-awesome-element'),\n]);\n\n// router config\nconfigureRouter(config, router) {\n  this.router = router;\n  config.mapUnknownRoutes(PLATFORM.moduleName('./not-found'));\n  config.map([\n    {\n      route: '',\n      name: 'home',\n      title: 'Home'\n      nav: true,\n      moduleId: PLATFORM.moduleName('./home')\n    }\n  ]);\n}\n```\n\n> Info: aurelia-webpack-plugin\n> The `PLATFORM.moduleName` is processed by [aurelia-webpack-plugin](https://github.com/aurelia/webpack-plugin). The plugin is the magic piece that bridges Webpack with Aurelia's dynamic behavior.\n\n## Running the application\n> Info\n> This section does not apply for ASP.NET JavascriptServices\n\nRunning an Aurelia-CLI Webpack application is simple: `au run` and you're on your way. But it's good to be aware of other flags that can be supplied to the `au run` command. `au --help` shows you all supported flags, but there are a couple that we would like to highlight.\n\nIf you're interested in Hot Module Reload, you can use the `--hmr` flag (e.g. `au run --hmr`) to launch in Hot Module Reload mode. Another cool one is `au run --analyze` which opens up the Webpack Bundler Analyzer, giving you a nice visualization of the bundle contents.\n\nLet's now take a look at the `platform` section in `aurelia.json`:\n\n<code-listing heading=\"Platform options\">\n  <source-code lang=\"JavaScript\">\n  \"platform\": {\n    \"id\": \"web\",\n    \"displayName\": \"Web\",\n    \"port\": 8080,\n    \"hmr\": false,\n    \"open\": false,\n    \"output\": \"dist\"\n  },\n  </source-code>\n</code-listing>\n\nHere you can find default settings for `au run` and `au build`. If you always run in Hot Module Reload mode, you can set `hmr` to `true` and you don't need to supply the `--hmr` flag any longer. Enabling the `open` option will cause the browser to navigate to the site after Webpack has finished bundling. The `output` option is used in the `webpack.config.js` file to determine where to output all the assets. If you're looking to change the default port that `au run` uses, you can change the `port` option in this section.\n\n## Deploying Your App\nWhen your application is done, the next step is to deploy it. First you will want to create a production build with `au build --env prod`. Depending on whether you use ASP.NET Core or not, the build output will end up in the `dist` folder or the `wwwroot/dist` folder.\n\nIf you're not using ASP.NET core then everything you need to deploy can be found in the dist folder. Just copy this to the webserver and you'll be good to go. For ASP.NET Core however you'll want to do a production build (`au build --env prod`) and then deploy the ASP.NET Core application. Details can be found in the [Microsoft Docs](https://docs.microsoft.com/en-us/aspnet/core/publishing/?tabs=aspnetcore2x).\n\n## Build options\nWhen you look in the `webpack.config.js` you'll see that it exports a function:\n\n```\nmodule.exports = ({production, server, extractCss, coverage} = {}) => ({\n```\n\nThe configuration that's returned from the function is based on the parameters that get passed in. That means that you can have a different Webpack config for production and development, but you can also configure whether to extract any CSS.\n\nThe build and run tasks passes in these parameters. Most of these settings are defined in the `build.options` object in `aurelia.json`:\n\n<code-listing heading=\"Build options\">\n  <source-code lang=\"JavaScript\">\n\t\"build\": {\n\t\t\"options\": {\n\t\t  \"server\": \"dev\",\n\t\t  \"extractCss\": \"prod\",\n\t\t  \"coverage\": false\n\t\t}\n\t},\n  </source-code>\n</code-listing>\n\nOne is missing though: `production`. The environment (whether it's a production build or not) is determined from the `--env` flag. `au build` creates a development build, while `au build --env prod` creates production build.\n\n## Installing 3rd party dependencies\nWebpack is a powerful and smart bundler, which means that you often don't need to configure a 3rd party dependency.  And if you do then there's a good chance that someone has done it before, so Google is your friend here.\n\nCheck out the [Webpack documentation](https://webpack.js.org/concepts/) for more info on the `webpack.config.js`.\n\n## Unit Testing\nDepending on what you've selected during `au new` you will have the possibility to run one of the following test runners:\n\n- Jest\n- Karma\n- Protractor\n\nJest can be launched using `au jest` or `au jest --watch` if you would like to do continuously run tests.\n\nSimilarly, Karma can be started using `au karma` or `au karma --watch`.\n\nHowever, Protractor is a bit different. It has to be started through `nps`, so make sure that you've installed that globally (`npm install nps -g`). Afterwards, run `nps e2e` to start Protractor.\n\n## ASP.NET Core\nWhen developing an ASP.NET Core application you will want to set the `ASPNETCORE_ENVIRONMENT` environment variable. Detailed instructions can be found on the [Microsoft Docs](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/environments#setting-the-environment)."}