{"name":"Integrating with Polymer","description":"Polymer is a library for creating reusable web components declaratively with extra features like data binding and property observation. In many ways, it is similar to Aurelia's component support. However, Polymer also includes an extensive catalog of custom elements for everything from material design to credit card forms to embedding Google services like Google Maps and YouTube. With a bit of work, these components can be incorporated into Aurelia applications as well.","author":{"name":"Ben Navetta","url":"https://www.linkedin.com/in/benjaminnavetta"},"links":{"static":"docs/integration/polymer","html":"docs/integration/polymer/index.html","fragment":"docs/integration/polymer/index-fragment.html","self":"docs/integration/polymer/index.json"},"content":"\n## Setup\n\nThe first step is obtaining Polymer, which is generally done with the [Bower](http://bower.io/) package manager. The following `bower.json` will install Polymer's base and material design elements.\n\n<code-listing heading=\"Bower Config\">\n  <source-code lang=\"JSON\">\n    {\n      \"name\": \"my-aurelia-polymer-project\",\n      \"private\": true,\n      \"dependencies\": {\n        \"polymer\": \"Polymer/polymer#^1.2.0\",\n        \"paper-elements\": \"PolymerElements/paper-elements#^1.0.6\",\n        \"iron-elements\": \"PolymerElements/iron-elements#^1.0.4\",\n        \"webcomponentsjs\": \"webcomponents/webcomponentsjs#^0.7.20\"\n      }\n    }\n  </source-code>\n</code-listing>\n\nMake sure Bower is installed and then use Bower to install the packages for each of the Polymer elements.\n\n<code-listing heading=\"Bower Package Installation\">\n  <source-code lang=\"Shell\">\n    $ npm install -g bower\n    $ bower install\n  </source-code>\n</code-listing>\n\nAurelia must also be configured to use the HTML Imports template loader and the `aurelia-polymer` plugin, both of which can be installed with JSPM.\n\n<code-listing heading=\"Plugin Installation\">\n  <source-code lang=\"Shell\">\n    $ jspm install aurelia-html-import-template-loader\n    $ jspm install aurelia-polymer@^1.0.0-beta\n  </source-code>\n</code-listing>\n\nIn `index.html`, Polymer and the webcomponents.js polyfills need to be loaded before Aurelia is, so that the `aurelia-polymer` plugin can hook into Polymer's element registration system.\n\n<code-listing heading=\"Loading Web Components and Polymer\">\n  <source-code lang=\"HTML\">\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <!-- ... -->\n        <script src=\"bower_components/webcomponentsjs/webcomponents-lite.js\"></script>\n        <link rel=\"import\" href=\"bower_components/polymer/polymer.html\">\n      </head>\n      <!-- ... -->\n    </html>\n  </source-code>\n</code-listing>\n\nIt's also a good idea to wait until the web components polyfill has loaded Polymer to bootstrap Aurelia. Instead of directly importing `aurelia-bootstrapper`, wait until the `WebComponentsReady` event fires in `index.html`.\n\n<code-listing heading=\"Bootstrapping Aurelia\">\n  <source-code lang=\"HTML\">\n    <!DOCTYPE html>\n    <script>\n      document.addEventListener('WebComponentsReady', function() {\n        System.import('aurelia-bootstrapper');\n      });\n    </script>\n  </source-code>\n</code-listing>\n\nIn `main.js`, the two Aurelia plugins installed before need to be loaded as well.\n\n<code-listing heading=\"Configuring Aurelia\">\n  <source-code lang=\"ES 2015/2016\">\n    export function configure(aurelia) {\n      aurelia.use\n        .standardConfiguration()\n        .developmentLogging();\n\n      aurelia.use.plugin('aurelia-polymer');\n      aurelia.use.plugin('aurelia-html-import-template-loader');\n\n      aurelia.start().then(a => a.setRoot());\n    }\n  </source-code>\n  <source-code lang=\"TypeScript\">\n    import {Aurelia} from 'aurelia-framework';\n\n    export function configure(aurelia: Aurelia): void {\n      aurelia.use\n        .standardConfiguration()\n        .developmentLogging();\n\n      aurelia.use.plugin('aurelia-polymer');\n      aurelia.use.plugin('aurelia-html-import-template-loader');\n\n      aurelia.start().then(a => a.setRoot());\n    }\n  </source-code>\n</code-listing>\n\nAt this point, Aurelia and Polymer are ready to go. The examples below incorporate various Polymer elements into the Aurelia skeleton navigation starter.\n\n## Importing Elements\n\nWith the normal Aurelia template loader, nothing is allowed outside the root `<template>` element. When using HTML imports, however, the import statements must be before the `<template>`.\n\n<code-listing heading=\"Using HTML Imports\">\n  <source-code lang=\"HTML\">\n    <link rel=\"import\" href=\"/bower_components/paper-drawer-panel/paper-drawer-panel.html\">\n    <link rel=\"import\" href=\"/bower_components/paper-toolbar/paper-toolbar.html\">\n    <link rel=\"import\" href=\"/bower_components/paper-menu/paper-menu.html\">\n    <link rel=\"import\" href=\"/bower_components/paper-item/paper-item.html\">\n    <link rel=\"import\" href=\"/bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html\">\n    <link rel=\"import\" href=\"/bower_components/paper-icon-button/paper-icon-button.html\">\n    <link rel=\"import\" href=\"/bower_components/iron-icons/iron-icons.html\">\n\n    <template>\n      <!-- ... -->\n    </template>\n  </source-code>\n</code-listing>\n\n## Data Binding\n\nGiven the imports above, this shows how to implement a basic layout in `app.html` with Polymer components.\n\n<code-listing heading=\"Using Polymer Elements\">\n  <source-code lang=\"HTML\">\n    <template>\n      <paper-drawer-panel force-narrow>\n        <div drawer>\n          <paper-toolbar class=\"paper-header\">\n            <span>Menu</span>\n          </paper-toolbar>\n          <paper-menu>\n            <paper-item repeat.for=\"row of router.navigation\" active.bind=\"row.isActive\">\n              <a href.bind=\"row.href\">${row.title}</a>\n            </paper-item>\n          </paper-menu>\n        </div>\n        <div main>\n          <paper-toolbar class=\"paper-header\">\n            <paper-icon-button icon=\"menu\" tabindex=\"1\" paper-drawer-toggle></paper-icon-button>\n            <div class=\"title\">${router.title}</div>\n            <span if.bind=\"router.isNavigating\"><iron-icon icon=\"autorenew\"/></span>\n          </paper-toolbar>\n          <div>\n            <router-view></router-view>\n          </div>\n        </div>\n      </paper-drawer-panel>\n    </template>\n  </source-code>\n</code-listing>\n\nNotice that Poylmer elements such as `<paper-drawer-panel>` or `<paper-menu>`, once imported, can be used just like\nnormal HTML elements.\n\nAll of the standard Aurelia binding syntax continues to work as well. For example,\n`repeat.for` is used to populate menu items from the Aurelia router. The `active.bind`\nbinding on the `<paper-item>` elements in the navigation menu shows that attributes\ndefined by Polymer are also supported by Aurelia.\n\n## Forms and Two-Way Binding\n\nThe updated `welcome.html` uses Polymer input elements to enhance its form.\n\n<code-listing heading=\"Using Polymer in a Form\">\n  <source-code lang=\"HTML\">\n    <link rel=\"import\" href=\"../bower_components/paper-input/paper-input.html\">\n    <link rel=\"import\" href=\"../bower_components/iron-form/iron-form.html\">\n\n    <template>\n      <section class=\"au-animate\">\n        <h2>${heading}</h2>\n        <form is=\"iron-form\" role=\"form\" submit.delegate=\"submit()\">\n          <div class=\"form-group\">\n            <label for=\"fn\">First Name</label>\n            <paper-input id=\"fn\" value.two-way=\"firstName\" placeholder=\"first name\"></paper-input>\n          </div>\n          <div class=\"form-group\">\n            <label for=\"ln\">Last Name</label>\n            <paper-input id=\"fn\" value.two-way=\"lastName\" placeholder=\"last name\"></paper-input>\n          </div>\n          <div class=\"form-group\">\n            <label>Full Name</label>\n            <p class=\"help-block\">${fullName | upper}</p>\n          </div>\n          <button type=\"submit\" class=\"btn btn-default\">Submit</button>\n        </form>\n      </section>\n    </template>\n  </source-code>\n</code-listing>\n\nWhile not strictly necessary in this case, making the form an `<iron-form>` ensures\nthat Polymer input elements are submitted along with native HTML elements.\n\nNote that the `<paper-input>` elements have `.two-way` bindings, not just `.bind`.\nWith the exception of native HTML form elements, Aurelia defaults to one-way bindings,\nso two-way data binding must be specified explicitly.\n\nA normal `<button>` element is used with Aurelia's `submit.delegate` binding, since\nPolymer elements cannot submit forms.\n\nIf form submission semantics were not needed, another option would be to\nuse a `click.delegate` on a Polymer button instead.\n\n<code-listing heading=\"Polymer Element with Event Delegation\">\n  <source-code lang=\"HTML\">\n    <paper-button raised click.delegate=\"submit()\">Submit</paper-button>\n  </source-code>\n</code-listing>\n\n## How the Plugin Works\n\nThe `aurelia-polymer` plugin is fairly simple. For each Polymer element, it\nregisters the element's properties and what events they support with the\n`EventManager` in Aurelia's binding component. The core of the plugin, the\n[`registerElement`](https://github.com/roguePanda/aurelia-polymer/blob/1.0.0-beta.1.0.1/src/index.js#L7)\nfunction, loops over all properties of the element and any behavior it implements\nso that the Aurelia binding engine will register event listeners properly.\n\n<code-listing heading=\"Element Registration\">\n  <source-code lang=\"ES 2015/2016\">\n    var propertyConfig = {'bind-value': ['change', 'input']}; // Not explicitly listed for all elements that use it\n\n    function handleProp(propName, prop) {\n      if (prop.notify) {\n        propertyConfig[propName] = ['change', 'input'];\n      }\n    }\n\n    Object.keys(prototype.properties).forEach(propName => handleProp(propName, prototype.properties[propName]));\n\n    prototype.behaviors.forEach(behavior => {\n      if (typeof behavior.properties != 'undefined') {\n        Object.keys(behavior.properties).forEach(propName => handleProp(propName, behavior.properties[propName]));\n      }\n    });\n\n    eventManager.registerElementConfig({\n      tagName: prototype.is,\n      properties: propertyConfig\n    });\n  </source-code>\n  <source-code lang=\"TypeScript\">\n    var propertyConfig = {'bind-value': ['change', 'input']}; // Not explicitly listed for all elements that use it\n\n    function handleProp(propName, prop) {\n      if (prop.notify) {\n        propertyConfig[propName] = ['change', 'input'];\n      }\n    }\n\n    Object.keys(prototype.properties).forEach(propName => handleProp(propName, prototype.properties[propName]));\n\n    prototype.behaviors.forEach(behavior => {\n      if (typeof behavior.properties != 'undefined') {\n        Object.keys(behavior.properties).forEach(propName => handleProp(propName, behavior.properties[propName]));\n      }\n    });\n\n    eventManager.registerElementConfig({\n      tagName: prototype.is,\n      properties: propertyConfig\n    });\n  </source-code>\n</code-listing>\n\nElement properties marked with `notify` are eligible for Polymer's two-way data\nbinding system and also trigger a `{property-name}-changed` event. This corresponds\nto the `input` and `change` events in Aurelia.\n\nWhenever a Polymer element is imported, it triggers a call to `Polymer.telemetry._registrate`,\nwhich adds the element prototype to a list of registered Polymer elements. The\n`aurelia-polymer` plugin replaces this registration function with one that also\ncalls `registerElement` on the prototype so that it is configured with Aurelia\nas well. The need to override this function is why Polymer must be loaded before\nthe plugin is.\n"}