<section class="article">
  <header>
    <h1>HTTP Services</h1>
    <h2>Usually JavaScript applications need to get their data from or communicate with various web services. In this article we&#x27;ll take a look at the options Aurelia makes available to you.</h2>
  </header>

  <article class="markdown">
    <section><h2 id="options">Options</h2><p>When building front-end applications, it's often necessary to leverage HTTP services to acquire data or persist state. There are many ways to accomplish this. You could use an advanced data library that implements object-relational mapping, an opinionated restful client or just a simple HTTP library. All these options are provided by the global web community and all of them can be used in an Aurelia application.</p>
<p>That said, the Aurelia team felt the need to provide a simple solution out of the box. We wanted our community to have a directly supported option while still keeping Aurelia open so that our own community could innovate or leverage any other library developed elsewhere.</p>
<p>Along these lines, the Aurelia project provides two options:</p>
<ul>
<li><code>aurelia-http-client</code> - A basic HttpClient based on XMLHttpRequest. It supports all HTTP verbs, JSONP and request cancellation.</li>
<li><code>aurelia-fetch-client</code> - A more forward-looking HttpClient based on the Fetch specification. It supports all HTTP verbs and integrates with Service Workers, including Request/Response caching.</li>
</ul>
<p>How should you choose between these two options? We recommend using <code>aurelia-fetch-client</code> if possible. It is based on the Fetch specification which will be the preferred way of handling all AJAX going forward. However, if you need request cancellation or download progress, the Fetch spec does not currently support these features. While these improvements to the spec are being considered for the future, it isn't available at present. So, if you need these capabilities, you may need to use <code>aurelia-http-client</code> instead.</p>
</section>
<section><h2 id="aurelia-fetch-client">aurelia-fetch-client</h2><p>As previously stated, the <code>aurelia-fetch-client</code> library aims to embrace and expose the new 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank">Fetch API</a>
, while providing features important in web applications: default configuration of request parameters, interceptors and centralized request tracking. The main method, <code>HttpClient#fetch()</code>, has the same signature as <code>window.fetch()</code>. The difference is that our <code>HttpClient</code> will apply default configuration values, execute any registered interceptors and track the number of active requests.</p>
<div class="info"><div class="icon"> <i></i> </div><h4>Learn About The Fetch Spec</h4><p>
If you are looking for some information on the Fetch API specification, we recommend that you start with the 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank">MDN documentation</a>
. You may also find 
<a href="http://jakearchibald.com/2015/thats-so-fetch/" target="_blank">Jake Archibald</a>
 useful.</p>
</div>
<h3>Bring Your Own Polyfill</h3>
<p>This library relies on the Fetch API, which is not yet supported by all popular browsers. <em>This library does not include a polyfill for Fetch.</em> If you need to support 
<a href="http://caniuse.com/#feat=fetch" target="_blank">browsers that have not implemented Fetch</a>
, you will need to install a polyfill like 
<a href="https://github.com/github/fetch" target="_blank">GitHub</a>
.</p>
<p>First, install the polyfill using your package manager. Second, make sure to import the polyfill into your application code so that it's correctly initialized before you use our fetch client. The best place to load the polyfill is typically in your application's <code>main</code> module. That might look something like this:</p>
<code-listing heading="Initializing the Fetch Polyfill">
  <source-code lang="ES 2015/2016"><pre class="language-javascript"><code>
    <span class="token keyword">import</span> <span class="token string">'fetch'</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">configure</span><span class="token punctuation">(</span>aurelia<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      aurelia<span class="token punctuation">.</span>use
        <span class="token punctuation">.</span><span class="token function">standardConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">developmentLogging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      aurelia<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> aurelia<span class="token punctuation">.</span><span class="token function">setRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </code></pre></source-code>
  <source-code lang="TypeScript"><pre class="language-typescript"><code>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>Aurelia<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'aurelia-framework'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token string">'fetch'</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">configure</span><span class="token punctuation">(</span>aurelia<span class="token punctuation">:</span> Aurelia<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
      aurelia<span class="token punctuation">.</span>use
        <span class="token punctuation">.</span><span class="token function">standardConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">developmentLogging</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      aurelia<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> aurelia<span class="token punctuation">.</span><span class="token function">setRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </code></pre></source-code>
</code-listing>
<div class="info"><div class="icon"> <i></i> </div><h4>Encapsulate HttpClient Use</h4><p>
Generally, we recommend that you don't litter your application code with usage of the HttpClient. Instead, we reccommend that you create one or more service classes that encapsulate all HTTP access behind a friendly, application-specific API. If you do this, we also recommend that you import the <code>fetch</code> polyfill inside these service modules rather than in your application's main module. This helps to preserve the encapsulation.</p>
</div>
<h3>Basic Use</h3>
<p>Data requests are accomplished by calling the <code>fetch</code> method on an instance of <code>HttpClient</code>. By default, <code>fetch</code> makes <code>GET</code> requests. All calls to <code>fetch</code> return a <code>Promise</code> which will resolve to a <code>Response</code> object. Using this <code>Response</code> object, you can easily parse content, read headers and inspect status codes. See the Fetch API spec for more information.</p>
<p>Below is a simple sample demonstrating a basic <code>GET</code> request to a JSON file, including parsing of the response content and writing data values out to the console.</p>
<code-listing heading="GET JSON with Fetch">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>HttpClient<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'aurelia-fetch-client'</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    client<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=</span><span class="token operator">></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<h3>Configuration</h3>
<p>An <code>HttpClient</code> instance can be configured with several options, such as default headers and interceptors to be run on requests or responses.</p>
<code-listing heading="Configuring Fetch Client">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    httpClient<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>config <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      config
        <span class="token punctuation">.</span><span class="token function">withBaseUrl</span><span class="token punctuation">(</span><span class="token string">'api/'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withDefaults</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          credentials<span class="token punctuation">:</span> <span class="token string">'same-origin'</span><span class="token punctuation">,</span>
          headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>
            <span class="token string">'X-Requested-With'</span><span class="token punctuation">:</span> <span class="token string">'Fetch'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token function">request</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Requesting </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>request<span class="token punctuation">.</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>request<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> request<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token function">response</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Received </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> response<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<p>In the example above, <code>withBaseUrl()</code> is used to specify a base url that all fetches will be relative to.</p>
<p><code>withDefaults()</code> allows passing an object that can include any properties described in the optional <code>init</code> parameter to the 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/Request" target="_blank">Request constructor</a>
, and will be merged into the new 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Request" target="_blank">Request</a>
 before it is passed to the first request interceptor.</p>
<p><code>withInterceptor()</code> enables passing an object which can provide any of these four optional methods: <code>request</code>, <code>requestError</code>, <code>response</code>, and <code>responseError</code>. Here's an explanation of how each of these methods work:</p>
<ul>
<li><code>request</code> takes the 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Request" target="_blank">Request</a>
 that will be passed to <code>window.fetch()</code> after interceptors run. It should return the same Request, or create a new one. It can also return a 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Response" target="_blank">Response</a>
 to short-circuit the call to <code>fetch()</code> and complete the request immediately. Errors thrown in request interceptors will be handled by <code>requestError</code> interceptors.</li>
<li><code>requestError</code> acts as a Promise rejection handler during Request creation and request interceptor execution. It will receive the rejection reason, and can either re-throw, or recover by returning a valid Request.</li>
<li><code>response</code> will be run after <code>fetch()</code> completes, and will receive the resulting 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Response" target="_blank">Response</a>
. As with <code>request</code>, it can either pass the Response along, return a modified response, or throw.</li>
<li><code>responseError</code> is similar to <code>requestError</code>, and acts as a Promise rejection handler for response rejections.</li>
</ul>
<h3>Helpers</h3>
<p>The Fetch API has a couple gotchas, documented by the 
<a href="https://github.com/github/fetch#caveats" target="_blank">GitHub Fetch polyfill</a>
 docs. <code>aurelia-fetch-client</code> provides configuration helpers to apply the changes suggested by the polyfill docs.</p>
<ul>
<li><code>config.rejectErrorResponses()</code> will add a response interceptor that causes responses with unsuccessful status codes to result in a rejected Promise.</li>
<li><code>config.useStandardConfiguration()</code> will apply <code>rejectErrorResponses()</code>, and also configure <code>credentials: 'same-origin'</code> as a default on all requests.</li>
<li>The Fetch API has no convenient way of sending JSON in the body of a request. Objects must be manually serialized to JSON, and the <code>Content-Type</code> header set appropriately. aurelia-fetch-client includes a helper called <code>json</code> for this.</li>
</ul>
<code-listing heading="POST JSON with Fetch">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>HttpClient<span class="token punctuation">,</span> json<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'aurelia-fetch-client'</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> comment <span class="token operator">=</span> <span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> <span class="token string">'Awesome!'</span><span class="token punctuation">,</span>
      content<span class="token punctuation">:</span> <span class="token string">'This Fetch client is pretty rad.'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    httpClient<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'comments'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token function">json</span><span class="token punctuation">(</span>comment<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<h3>A Complete Example</h3>
<p>This example creates a new <code>HttpClient</code> and configures it for use with an imaginary JSON API for managing comments at <code>api/</code>. The client is then used to POST a new comment to the API and display an alert dialog with the assigned comment ID.</p>
<code-listing heading="POST JSON with Fetch">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>HttpClient<span class="token punctuation">,</span> json<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'aurelia-fetch-client'</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> httpClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    httpClient<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>config <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      config
        <span class="token punctuation">.</span><span class="token function">useStandardConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withBaseUrl</span><span class="token punctuation">(</span><span class="token string">'api/'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withDefaults</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          credentials<span class="token punctuation">:</span> <span class="token string">'same-origin'</span><span class="token punctuation">,</span>
          headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">'X-Requested-With'</span><span class="token punctuation">:</span> <span class="token string">'Fetch'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">withInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token function">request</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> authHeader <span class="token operator">=</span> fakeAuthService<span class="token punctuation">.</span><span class="token function">getAuthHeaderValue</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
            request<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'Authorization'</span><span class="token punctuation">,</span> authHeader<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> request<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> comment <span class="token operator">=</span> <span class="token punctuation">{</span>
      title<span class="token punctuation">:</span> <span class="token string">'Awesome!'</span><span class="token punctuation">,</span>
      content<span class="token punctuation">:</span> <span class="token string">'This Fetch client is pretty rad.'</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    httpClient
      <span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'comments'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        body<span class="token punctuation">:</span> <span class="token function">json</span><span class="token punctuation">(</span>comment<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>response <span class="token operator">=</span><span class="token operator">></span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>savedComment <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Saved comment! ID: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>savedComment<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span>error <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Error saving comment!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<h3>Limitations</h3>
<ul>
<li>This library does not include a polyfill for Fetch. If you need to support 
<a href="http://caniuse.com/#feat=fetch" target="_blank">browsers that have not implemented Fetch</a>
, you will need to install a polyfill like 
<a href="https://github.com/github/fetch" target="_blank">GitHub</a>
.</li>
<li>This library does not work around any of the existing limitations in the Fetch API, including:
<ul>
<li>Fetch does not currently support aborting requests or specifying request timeouts.</li>
<li>Fetch does not currently support progress reporting.</li>
</ul>
</li>
<li>JSONP support is not currently provided by this library.</li>
<li>The 
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/Request" target="_blank">Request constructor</a>
 provides its own default values, so if a Request is created before invoking <code>HttpClient#fetch</code> (eg, the <code>HttpClient#fetch(request)</code> signature is used instead of the <code>HttpClient#fetch(url, params)</code> signature), there is no way for the client to know which default values to merge into the Request. The base URL and headers can be merged, but currently no other defaults will be applied in this case.</li>
</ul>
<p>If your application has requirements that don't fit within these limitations, then you may want to look into using <code>aurelia-http-client</code> instead.</p>
</section>
<section><h2 id="aurelia-http-client">aurelia-http-client</h2><p>In addition to <code>aurelia-fetch-client</code>, Aurelia includes a basic <code>HttpClient</code> to provide a comfortable interface to the browser's <code>XMLHttpRequest</code> object. Like <code>aurelia-fetch-client</code>, <code>aurelia-http-client</code> is not included in the modules that Aurelia's bootstrapper installs, since it's completely optional and many apps may choose to use a different strategy for data retrieval. So, if you want to use it, first you must install it with your preferred package manager.</p>
<h3>Basic Use</h3>
<p>Once installed, you can use it like this:</p>
<code-listing heading="GET JSON with Basic HTTP">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>HttpClient<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'aurelia-http-client'</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    client<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>data <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>description<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<p>The <code>HttpClient</code> has a variety of methods. The following is a description of the APIs available.</p>
<code-listing heading="HTTPClient API">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HttpClient</span> <span class="token punctuation">{</span>
      isRequesting<span class="token punctuation">:</span> boolean<span class="token punctuation">;</span>

      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">configure</span><span class="token punctuation">(</span>fn<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>builder<span class="token punctuation">:</span> RequestBuilder<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HttpClient<span class="token punctuation">;</span>
      <span class="token function">createRequest</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> RequestBuilder<span class="token punctuation">;</span>
      <span class="token function">send</span><span class="token punctuation">(</span>requestMessage<span class="token punctuation">:</span> RequestMessage<span class="token punctuation">,</span> transformers<span class="token punctuation">:</span> Array<span class="token operator">&lt;</span>RequestTransformer<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>

      <span class="token keyword">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
      <span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
      <span class="token function">head</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
      <span class="token function">jsonp</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">,</span> callbackParameterName<span class="token operator">?</span><span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
      <span class="token function">options</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
      <span class="token function">put</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">,</span> content<span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
      <span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">,</span> content<span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
      <span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">,</span> content<span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </code></pre></source-code>
</code-listing>
<p>As you can see, the API provides convenience methods for all the standard verbs as well as <code>jsonp</code>. Each of these methods sends an <code>HttpRequestMessage</code> except <code>jsonp</code> which sends a <code>JSONPRequestMessage</code>. The result of sending a message is a <code>Promise</code> for an <code>HttpResponseMessage</code>.</p>
<p>The <code>HttpResponseMessage</code> has the following properties:</p>
<ul>
<li><code>response</code> - Returns the raw content sent from the server.</li>
<li><code>responseType</code> - The expected response type.</li>
<li><code>content</code> - Formats the raw <code>response</code> content based on the <code>responseType</code> and returns it.</li>
<li><code>headers</code> - Returns a <code>Headers</code> object with the parsed header data.</li>
<li><code>statusCode</code> - The server's response status code.</li>
<li><code>statusText</code> - The server's textual status message.</li>
<li><code>isSuccess</code> - Indicates whether or not the status code falls within the success range.</li>
<li><code>reviver</code> - A function used to transform the raw <code>response</code> content.</li>
<li><code>requestMessage</code> - A reference to the original request message.</li>
</ul>
<div class="info"><div class="icon"> <i></i> </div><h4>JSON By Default</h4><p>
By default, the <code>HttpClient</code> assumes you are expecting a JSON responseType.</p>
</div>
<h3>Configuration</h3>
<p>You can use <code>configure</code> to access a fluent api for configuring all requests sent by the client. You can also use <code>createRequest</code> to custom configure individual requests. Here's an example of configuration:</p>
<code-listing heading="Configuring Basic HTTP">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        x<span class="token punctuation">.</span><span class="token function">withBaseUrl</span><span class="token punctuation">(</span><span class="token string">'http://aurelia.io'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        x<span class="token punctuation">.</span><span class="token function">withHeader</span><span class="token punctuation">(</span><span class="token string">'Authorization'</span><span class="token punctuation">,</span> <span class="token string">'bearer 123'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    client<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'some/cool/path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<p>In this case, all requests from the client will have the base url of 'http://aurelia.io' and will have the specified Authorization header. The same API is available via the <code>RequestBuilder</code>. So, you can accomplish the same thing on an individual request like this:</p>
<code-listing heading="RequestBuilder API">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    client<span class="token punctuation">.</span><span class="token function">createRequest</span><span class="token punctuation">(</span><span class="token string">'some/cool/path'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">asGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">withBaseUrl</span><span class="token punctuation">(</span><span class="token string">'http://aurelia.io'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">withHeader</span><span class="token punctuation">(</span><span class="token string">'Authorization'</span><span class="token punctuation">,</span> <span class="token string">'bearer 123'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">withParams</span><span class="token punctuation">(</span><span class="token punctuation">{</span> abc<span class="token punctuation">:</span> <span class="token string">'123'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<p>The fluent API has the following chainable methods: <code>asDelete()</code>, <code>asGet()</code>, <code>asHead()</code>, <code>asOptions()</code>, <code>asPatch()</code>, <code>asPost()</code>, <code>asPut()</code>, <code>asJsonp()</code>, <code>withUrl()</code>, <code>withBaseUrl()</code>, <code>withContent()</code>, <code>withParams()</code>, <code>withResponseType()</code>, <code>withTimeout()</code>, <code>withHeader()</code>, <code>withCredentials()</code>, <code>withReviver()</code>, <code>withReplacer()</code>, <code>withProgressCallback()</code>, and <code>withCallbackParameterName()</code>.</p>
<p>It is possible to hook into requests and responses with interceptors as well. Here's an example:</p>
<code-listing heading="Basic HTTP Interceptors">
  <source-code lang="ES 2015/ES 2016/TypeScript"><pre class="language-javascript"><code>
    <span class="token keyword">let</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    client<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        x<span class="token punctuation">.</span><span class="token function">withInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token function">request</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> message<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>

          <span class="token function">requestError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> error<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>

          <span class="token function">response</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> message<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>

          <span class="token function">responseError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> error<span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </code></pre></source-code>
</code-listing>
<p>All interceptors used with a client form a chain. The return value of an intercept method is passed on as the argument to the next. Interceptors are called in the order they were added. See the <code>aurelia-fetch-client</code> interceptor documentation for more information on interceptors.</p>
</section>

  </article>
</section>
